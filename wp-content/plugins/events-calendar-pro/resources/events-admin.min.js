jQuery(document).ready(function(a){function r(){a("#publishing-action .button-primary-disabled").removeClass("button-primary-disabled");a("#publishing-action .spinner").hide()}function u(){var c=a('[name="recurrence[type]"]').val(),e=a('[name="recurrence[end]"]').val(),n=a('[name="recurrence[end-type]"]').val(),g=parseInt(a('[name="recurrence[end-count]"]').val()),l=a('[name="recurrence[custom-type]"]').val(),p=a('[name="recurrence[custom-interval]"]').val(),s=a("#recurrence-interval-type").text(),
f=a('[name="recurrence[custom-week-day][]"]:checked').map(function(){return a(this).val()}).get(),r=a('[name="recurrence[custom-month-number]"]').val(),u=a('[name="recurrence[custom-month-day]"]').val(),t=a('[name="recurrence[custom-year-month][]"]:checked').map(function(){return a(this).val()}).get();a('[name="recurrence[custom-year-filter]"]').val();var x=a('[name="recurrence[custom-year-month-number]"]').val(),C=a('[name="recurrence[custom-year-month-day]"]').val(),v="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),
y="January February March April May June July August September October November December".split(" "),A=["last","first","second","third","fourth"],b="Your event first occurs on "+a("#EventStartDate").val(),h=a("#EventEndDate").val().split("-"),h=new Date(h[0],h[1]-1,h[2]),k=a("#EventStartDate").val().split("-"),q=k=new Date(k[0],k[1]-1,k[2]),m=h;"Daily"==l&&(s=1<p?"days":"day");"Weekly"==l&&(s=1<p?"weeks":"week");"Monthly"==l&&(s=1<p?"months":"month");"Yearly"==l&&(s=1<p?"years":"year");if("After"==
n)if("Every Day"==c)q.setDate(k.getDate()+g-1),m.setDate(h.getDate()+g-1);else if("Every Week"==c)q.setDate(k.getDate()+7*(g-1)),m.setDate(h.getDate()+7*(g-1));else if("Every Month"==c)q.setMonth(k.getMonth()+g-1),m.setMonth(h.getMonth()+g-1);else if("Every Year"==c)q.setYear(k.getFullYear()+g-1),m.setYear(h.getFullYear()+g-1);else if("Custom"==c)if("Daily"==l)q.setDate(k.getDate()+(g-1)*p),m.setDate(h.getDate()+(g-1)*p);else if("Weekly"==l&&1<g){for(var h=["8"],k=k.getDay(),B=0,d=0;d<f.length;d++)if(1==
f.length||0<f[d]-k&&f[d]-k<h[0])for(var z=0,w=d;z<f.length;z++,w++)h[z]=f[w],w+1==f.length&&0<w&&(w=-1);d=g%f.length-1;"-1"==d&&(d=f.length-1);k+1!=h[f.length-1]&&(B=1,d--,"-1"==d&&(d=f.length-1));Math.ceil(g/f.length-B/f.length)}if("Custom"!=c)"After"==n?b+=" and repeats "+c.toLowerCase()+" for "+g+" "+a("#occurence-count-text").text():"On"==n&&""!=e&&(b+=" and repeats "+c.toLowerCase()+" until "+e);else{b+=" and repeats "+l.toLowerCase();b=1<p?b+(" every "+p+" "+s.toLowerCase()):b+(" every "+s.toLowerCase());
if("Weekly"==l&&f&&0<f.length){b+=" on ";for(d=0;d<f.length;d++)0==d?b+=v[f[d]-1]:d!=f.length-1&&0<d?b+=", "+v[f[d]-1]:(2<f.length&&(b+=","),b+=" and "+v[f[d]-1])}"Monthly"==l&&(b+=" on",isNaN(r)?(b+=" the "+r.toLowerCase(),b="-1"==u?b+" day":b+(" "+v[u-1])):b+=" day "+r);if("Yearly"==l){b+=" in ";for(d=0;d<t.length;d++)0==d?b+=y[t[d]-1]:d!=t.length-1&&0<d?b+=", "+y[t[d]-1]:(2<t.length&&(b+=","),b+=" and "+y[t[d]-1]);a('[name="recurrence[custom-year-filter]"]').is(":checked")&&(b+=" on the ",b="-1"==
x?b+A[0]:b+A[x],b+=" "+v[C-1])}"After"==n?b+=" for "+g+" occurrences":"On"==n&&""!=e&&(b+=" until "+e)}b+=".";"After"==n&&"Custom"!=c&&(b+=" The final occurrence begins",b=m.getTime()===q.getTime()?b+(" and ends on "+m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate()+"."):b+(" on "+q.getFullYear()+"-"+(q.getMonth()+1)+"-"+q.getDate()+" and ends on "+m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate()+"."));"None"==c&&a(".recurrence-pattern-description-row").hide();a("#recurrence-pattern-description").text(b)}
a("#event_venue input, #event_venue select").change(function(){var c=a("#saved_venue option:selected");if(0==c.val()){var e=a(this).closest("form"),c=e.find('[name="venue[Address]"]').val(),n=e.find('[name="venue[City]"]').val(),g=e.find('[name="venue[Country]"]').val(),l="US"==e.find('[name="venue[Country]"] option:selected').val()?e.find('[name="venue[State]"]').val():e.find('[name="venue[Province]"]').val(),e=e.find('[name="venue[Zip]"]').val();"function"==typeof codeAddress&&codeAddress(c+","+
n+","+l+","+g+","+e)}else"function"==typeof codeAddress&&codeAddress(c.data("address"))});a("#doaction, #doaction2").click(function(c){var e=a(this).attr("id").substr(2);if("edit"==a('select[name="'+e+'"]').val()&&"tribe_events"==a(".post_type_page").val()){c.preventDefault();var n=[];a("#bulk-titles div").each(function(){var c=a(this).attr("id"),e=c.replace("ttle",""),e=a("#post-"+e+" .row-title").first().text(),p=a("<div/>").append(a(this).find("a"));a(this).html("").append(p).append(e);n[c]&&a(this).remove();
n[c]=!0})}});a(".wp-admin.events-cal #post").submit(function(c){var e;e=a('[name="recurrence[custom-interval]"]').val()!=parseInt(a('[name="recurrence[custom-interval]"]').val())&&"Custom"==a('[name="recurrence[type]"] option:selected').val()?!1:!0;e||(c.preventDefault(),alert(a("#rec-days-error").text()),a("#rec-days-error").show(),r())});a(".ui-dialog-titlebar .ui-dialog-titlebar-close").live("click",function(){r()});a(".wp-admin.events-cal #post").submit(function(c){var e;e="None"!=a('[name="recurrence[type]"]').val()&&
"On"==a('[name="recurrence[end-type]"] option:selected').val()?a('[name="recurrence[end]"]').val()&&!a('[name="recurrence[end]"]').hasClass("placeholder"):!0;e||(c.preventDefault(),alert(a("#rec-end-error").text()),a("#rec-end-error").show(),r())});a("#recurrence_end, #EventStartDate, #EventEndDate").datepicker("option","onClose",function(){u();x()});a(".recurrence-row, .custom-recurrence-row").on("change",function(c){a(".recurrence-pattern-description-row").is(":visible")||a(".recurrence-pattern-description-row").show();
u()});var x=function(){var c=a("#EventStartDate").val();""!=c&&a("#recurrence_end").attr("placeholder",c).datepicker("option","minDate",c)};x();a('input[name="post[]"]').click(function(c){c=a(this).val();a(this).is(":checked")?a('input[name="post[]"][value="'+c+'"]').prop("checked",!0):a('input[name="post[]"][value="'+c+'"]').prop("checked",!1)});a(".wp-list-table.posts").on("click",".tribe-split",function(){var c="",c=a(this).hasClass("tribe-split-all")?TribeEventsProAdmin.recurrence.splitAllMessage:
TribeEventsProAdmin.recurrence.splitSingleMessage;if(!window.confirm(c))return!1});a(".wp-admin.events-cal.edit-php #doaction").click(function(c){"trash"==a("[name='action'] option:selected").val()&&0<a('.tribe-recurring-event-parent [name="post[]"]:checked').length&&!confirm(TribeEventsProAdmin.recurrence.bulkDeleteConfirmationMessage)&&c.preventDefault()})});
