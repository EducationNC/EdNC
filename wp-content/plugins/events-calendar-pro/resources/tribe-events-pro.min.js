Object.prototype.hasOwnProperty.call(window,"tribe_ev")&&(tribe_ev.geoloc={map:[],geocoder:[],geocodes:[],bounds:[],markers:[],refine:!1});
(function(p,n,a,m,g,e,f,k,q){a.extend(tribe_ev.fn,{has_address:function(a,b){for(var c=0;c<b.length;c++)if(b[c].formatted_address==a)return!0;return!1},pre_ajax:function(d){if(a("#tribe-bar-geoloc").length){var b=a("#tribe-bar-geoloc").val();b.length?g.process_geocoding(b,function(c){e.geocodes=c;if(1<e.geocodes.length&&!g.has_address(b,e.geocodes))g.print_geo_options();else{var h=c[0].geometry.location.lat();c=c[0].geometry.location.lng();h&&a("#tribe-bar-geoloc-lat").val(h);c&&a("#tribe-bar-geoloc-lng").val(c);
d&&"function"===typeof d&&(a("#tribe_events_filter_item_geofence").length&&a("#tribe_events_filter_item_geofence").show(),d())}}):(a("#tribe-bar-geoloc-lat, #tribe-bar-geoloc-lng").val(""),d&&"function"===typeof d&&(a("#tribe_events_filter_item_geofence").length&&(a("#tribe_events_filter_item_geofence input").prop("checked",!1),a("#tribe_events_filter_item_geofence").hide().find("select").prop("selectedIndex",0)),d()))}else d&&"function"===typeof d&&d()},print_geo_options:function(){a("#tribe-geo-links").empty();
a("#tribe-geo-options").show();var d=[];e.refine=!0;for(var b=0;b<e.geocodes.length;b++){var c=e.geocodes[b].formatted_address;d[c]||(d[c]=!0,a("<a/>").text(c).attr("href","#").addClass("tribe-geo-option-link").data("index",b).appendTo("#tribe-geo-links"),k.map_view()&&g.map_add_marker(e.geocodes[b].geometry.location.lat(),e.geocodes[b].geometry.location.lng(),c))}e.refine=!1},pro_tooltips:function(){a("#tribe-events").on("mouseenter",'div[id*="tribe-events-event-"], div[id*="tribe-events-daynum-"]:has(a), div.event-is-recurring',
function(){var d=0,b=a(this);if(a("body").hasClass("tribe-events-week")&&b.tribe_has_attr("data-tribejson"))if(b.parents(".tribe-grid-allday").length)c=b.find(".tribe-events-tooltip"),c.length||(c=b.data("tribejson"),b.find("div").append(tribe_tmpl("tribe_tmpl_tooltip",c)),c=b.find(".tribe-events-tooltip")),d=b.outerHeight()+6,c.css("bottom",d).show();else{var c=b.find(".tribe-events-tooltip");c.length||(c=b.data("tribejson"),b.append(tribe_tmpl("tribe_tmpl_tooltip",c)),c=b.find(".tribe-events-tooltip"));
var h=a(".tribe-week-grid-wrapper"),l=b.parent(),d=l.parent(),e=Math.ceil(d.width()),f=Math.ceil(b.width()),g=Math.ceil(c.outerWidth()),d=h.height(),k=h.scrollTop(),h=l.position(),b=b.position(),b=Math.ceil(b.top),b=k-b,l=l.hasClass("tribe-events-right"),k={};c.hasClass("hovered")||c.data("ow",g).addClass("hovered");e=l?Math.ceil(h.left)-20:e-f-Math.ceil(h.left);g=g>=e?e:c.data("ow")>e?e:c.data("ow");k=l?{right:f+20,bottom:"auto",width:g+"px"}:{left:f+20,bottom:"auto",width:g+"px"};c.css(k);f=c.height();
0<=b?b+=5:(d=b+d,b=f>d?d-f-8:5);c.css("top",b).show()}})},process_geocoding:function(a,b){var c={address:a,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(TribeEventsPro.geocenter.min_lat,TribeEventsPro.geocenter.min_lng),new google.maps.LatLng(TribeEventsPro.geocenter.max_lat,TribeEventsPro.geocenter.max_lng))};e.geocoder.geocode(c,function(a,c){if(c==google.maps.GeocoderStatus.OK)return b(a),a;c==google.maps.GeocoderStatus.ZERO_RESULTS&&GeoLoc.map_view&&spin_end();return c})},set_recurrence:function(a){a?
(f.recurrence=!0,tribe_storage&&tribe_storage.setItem("tribeHideRecurrence","1")):(f.recurrence=!1,tribe_storage&&tribe_storage.setItem("tribeHideRecurrence","0"))}});a.extend(tribe_ev.tests,{hide_recurrence:function(){return a("#tribeHideRecurrence:checked").length?!0:!1}});a(n).ready(function(){a(".tribe-bar-geoloc-filter").length&&a(".tribe-bar-geoloc-filter").append('<div id="tribe-geo-options"><div id="tribe-geo-links"></div></div>');var d=a("#tribe-events"),b=a("#tribe-bar-geoloc"),c=a("#tribe-geo-options"),
h=!1;g.pro_tooltips();k.hide_recurrence()&&g.set_recurrence(!0);f.recurrence=k.hide_recurrence();d.on("click","#tribeHideRecurrence",function(){f.popping=!1;f.do_string=!0;f.paged=1;h=a(this).is(":checked")?!0:!1;g.set_recurrence(h);a(m).trigger("tribe_ev_updatingRecurrence").trigger("tribe_ev_runAjax")});a(m).on("tribe_ev_preCollectBarParams",function(){b.length&&(b.val().length?"map"===f.view_target&&(f.url_params.action="tribe_geosearch"):a("#tribe-bar-geoloc-lat, #tribe-bar-geoloc-lng").val(""));
tribe_storage&&"1"===tribe_storage.getItem("tribeHideRecurrence")&&("month"!==f.view_target&&"week"!==f.view_target)&&(f.url_params.tribeHideRecurrence="1")});k.map_view()||(c.length&&(d.on("click",".tribe-geo-option-link",function(d){d.preventDefault();d.stopPropagation();d=a(this);a(".tribe-geo-option-link").removeClass("tribe-option-loaded");d.addClass("tribe-option-loaded");b.val(d.text());a("#tribe-bar-geoloc-lat").val(e.geocodes[d.data("index")].geometry.location.lat());a("#tribe-bar-geoloc-lng").val(e.geocodes[d.data("index")].geometry.location.lng());
g.pre_ajax(function(){a(m).trigger("tribe_ev_runAjax");c.hide()})}),a(n).on("click",function(a){c.hide()})),g.snap("#tribe-geo-wrapper","#tribe-geo-wrapper","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a"));a("#wp-toolbar").on("click",".tribe-split-single a, .tribe-split-all a",function(){var b="",b=a(this).parent().hasClass("tribe-split-all")?TribeEventsPro.recurrence.splitAllMessage:TribeEventsPro.recurrence.splitSingleMessage;if(!p.confirm(b))return!1});
q&&debug.info("TEC Debug: tribe-events-pro.js successfully loaded")})})(window,document,jQuery,tribe_ev.events,tribe_ev.fn,tribe_ev.geoloc,tribe_ev.state,tribe_ev.tests,tribe_debug);
