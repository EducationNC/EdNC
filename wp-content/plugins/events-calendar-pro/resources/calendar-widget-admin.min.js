function calendar_toggle(b){b.find(".calendar-widget-filters-title").hide();b.find(".calendar-widget-filters-operand").hide();var a=b.find(".calendar-widget-added-filters");a.length&&(a=a.val()?jQuery.parseJSON(a.val()):{},a=get_term_count(a),0<a&&(b.find(".calendar-widget-filters-title").show(),1<a&&b.find(".calendar-widget-filters-operand").show()))}function calendar_toggle_all(){jQuery(".calendar-widget-filters-container").each(function(b,a){calendar_toggle(jQuery(a))})}
function get_term_count(b){var a=0,c;for(c in b)a+=b[c].length;return a}
jQuery(document).ready(function(b){var a=b("body"),c={};a.is(".wp-customizer")&&(c={dropdownCssClass:"customizer-select2"});b("div.widgets-sortables").on("sortstop",function(){setTimeout(function(){b("#widgets-right select.calendar-widget-add-filter").select2(c);calendar_toggle_all()},600)});b("#widgets-right select.calendar-widget-add-filter").select2(c);a.on("change","select.calendar-widget-add-filter",function(a){b(".calendar-widget-filters-container").show();var e=b(this);a=b(this.options[this.selectedIndex]);
var e=e.parents(".widget-content"),k=e.find(".calendar-widget-filter-list"),d=e.find(".calendar-widget-added-filters"),f=a.attr("value"),g=a.closest("optgroup"),c=g.attr("id"),g=g.attr("label");if(0!==parseInt(f)){var h=d.val()?b.parseJSON(d.val()):{};h[c]||(h[c]=[]);-1==jQuery.inArray(f,h[c])&&(h[c].push(f),d.val(JSON.stringify(h)),d=b("<a/>").addClass("calendar-widget-remove-filter").attr("data-tax",c).attr("data-term",f).text("(remove)").attr("href","#"),d=b("<span/>").append(d),a=b("<li/>").append("p").text(g+
": "+a.text()+"   ").append(d),k.append(a),calendar_toggle(e))}});a.on("click",".calendar-widget-remove-filter",function(a){a.preventDefault();a=b(this);var e=a.attr("data-tax"),c=a.attr("data-term"),d=a.parents(".widget-content"),f=d.find(".calendar-widget-added-filters"),g=f.val()?b.parseJSON(f.val()):{};g[e]&&g[e].myremove(c);f.val(JSON.stringify(g));a.closest("li").remove();calendar_toggle(d)});Array.prototype.myremove=function(){for(var a,b=arguments,c=b.length,d;c&&this.length;)for(a=b[--c];-1!=
(d=this.indexOf(a));)this.splice(d,1);return this};Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;){if(this[b]===a)return b;++b}return-1})});
