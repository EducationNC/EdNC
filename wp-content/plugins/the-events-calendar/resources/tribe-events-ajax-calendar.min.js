(function(u,v,b,c,g,f,a,k,n){b(v).ready(function(){function z(a){var l=a;10>a&&(l="0"+a);var c=b('.tribe-mobile-day[data-day="'+a+'"]');a=b(".tribe-event-day-"+l+" .tribe-events-viewmore");l=b(".tribe-event-day-"+l+" .hentry");l.length&&(l.each(function(){var a=b(this);a.tribe_has_attr("data-tribejson")&&(a=a.data("tribejson"),c.append(tribe_tmpl("tribe_tmpl_month_mobile",a)))}),a.length&&c.append(a.clone()))}function q(a,c){var d=b("#tribe-mobile-container"),f=b(".tribe-mobile-day"),g=b(".mobile-trigger"),
h=b('.tribe-mobile-day[data-day="'+a+'"]'),k={date:a,date_name:"undefined"==typeof c?"":c};g.removeClass("mobile-active");g.filter('[data-day="'+a+'"]').addClass("mobile-active");f.hide();h.length?h.show():(d.append(tribe_tmpl("tribe_tmpl_month_mobile_day_header",k)),z(a))}function w(){b(".tribe-events-calendar th").each(function(){var a=b(this),c=a.attr("data-day-abbr"),d=a.attr("title");r.is(".tribe-mobile")?a.text(c):a.text(d)})}function t(a){if(r.is(".tribe-mobile")){w();a=b(".tribe-events-present");
var c=b(".mobile-trigger"),d=b("#tribe-events-content > .tribe-events-calendar");b("#tribe-mobile-container").length||b('<div id="tribe-mobile-container" />').insertAfter(d);a.length?q(a.attr("data-day"),a.attr("data-date-name")):q(c.first().attr("data-day"),c.first().attr("data-date-name"))}else a&&w()}function A(e){"change_view"!=tribe_events_bar_action&&(e.preventDefault(),a.ajax_running||(m.val().length?a.date="0"!==a.datepicker_format?tribeDateFormat(m.bootstrapDatepicker("getDate"),"tribeMonthQuery"):
m.val():x||(a.date=c.cur_date.slice(0,-3)),c.cur_url=a.filter_cats?b("#tribe-events-header").data("baseurl")+a.date+"/":s+a.date+"/",a.popping=!1,f.pre_ajax(function(){p()})))}function p(){f.invalid_date(a.date)||(b(".tribe-events-calendar").tribe_spin(),a.pushcount=0,a.ajax_running=!0,a.popping||(a.params={action:"tribe_calendar",eventDate:a.date},a.category&&(a.params.tribe_event_category=a.category),a.url_params={},b(g).trigger("tribe_ev_serializeBar"),a.params=b.param(a.params),a.url_params=b.param(a.url_params),
b(g).trigger("tribe_ev_collectParams"),0<a.pushcount||a.filters?(a.do_string=!0,a.pushstate=!1):(a.do_string=!1,a.pushstate=!0)),k.pushstate&&!a.filter_cats?(n&&debug.time("Month View Ajax Timer"),b(g).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_monthView_AjaxStart"),b.post(TribeCalendar.ajaxurl,a.params,function(e){a.initial_load=!1;f.enable_inputs("#tribe_events_filters_form","input, select");if(e.success){a.ajax_running=!1;c.ajax_response={total_count:"",view:e.view,max_pages:"",tribe_paged:"",
timestamp:(new Date).getTime()};n&&0===e.html&&debug.warn("Month view ajax had an error in the query and returned 0.");var d="",d=b.isFunction(b.fn.parseHTML)?b.parseHTML(e.html):e.html;b("#tribe-events-content").replaceWith(d);t(!0);a.page_title=b("#tribe-events-header").data("title");v.title=a.page_title;a.do_string&&(c.cur_url=c.cur_url+"?"+a.url_params,history.pushState({tribe_date:a.date,tribe_params:a.params},a.page_title,c.cur_url));a.pushstate&&history.pushState({tribe_date:a.date,tribe_params:a.params},
a.page_title,c.cur_url);b(g).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_monthView_ajaxSuccess");n&&debug.timeEnd("Month View Ajax Timer")}})):u.location=a.url_params.length?c.cur_url+"?"+a.url_params:c.cur_url)}var r=b("body"),h=b('[class^="tribe-events-nav-"] a'),s="/",d=f.get_url_param("tribe-bar-date"),m=b("#tribe-bar-date"),x=!1;h.length&&(s=h.first().attr("href").slice(0,-8));b(".tribe-events-calendar").length&&b("#tribe-events-bar").length&&(d&&7<d.length)&&(b("#tribe-bar-date-day").val(d.slice(-3)),
m.val(d.substring(0,7)));h="yyyy-mm";if("0"!==a.datepicker_format){var h=parseInt(a.datepicker_format),y="m"+a.datepicker_format.toString(),h=c.datepicker_formats.month[h];d&&(7>=d.length&&(d+="-01"),m.val(tribeDateFormat(d,y)))}c.datepicker_opts={format:h,minViewMode:"months",autoclose:!0};m.bootstrapDatepicker(c.datepicker_opts).on("changeDate",function(e){a.mdate=e.date;var d=e.date.getFullYear();e=("0"+(e.date.getMonth()+1)).slice(-2);x=!0;a.date=d+"-"+e;if((k.no_bar()||k.live_ajax()&&k.pushstate)&&
!a.ajax_running&&!a.updating_picker)c.cur_url=a.filter_cats?b("#tribe-events-header").data("baseurl")+a.date+"/":s+a.date+"/",a.popping=!1,f.pre_ajax(function(){p()})});t(!0);b(g).on("tribe_ev_resizeComplete",function(){t(!0)});k.pushstate&&!k.map_view()&&(d="action=tribe_calendar&eventDate="+b("#tribe-events-header").data("date"),c.params.length&&(d=d+"&"+c.params),a.category&&(d=d+"&tribe_event_category="+a.category),history.replaceState({tribe_params:d},a.page_title,location.href),b(u).on("popstate",
function(b){if(b=b.originalEvent.state)a.do_string=!1,a.pushstate=!1,a.popping=!0,a.params=b.tribe_params,f.pre_ajax(function(){p()}),f.set_form(a.params)}));b("#tribe-events").on("click",".tribe-events-nav-previous, .tribe-events-nav-next",function(e){e.preventDefault();a.ajax_running||(e=b(this).find("a"),a.date=e.data("month"),a.mdate=a.date+"-01","0"!==a.datepicker_format?f.update_picker(tribeDateFormat(a.mdate,y)):f.update_picker(a.date),c.cur_url=a.filter_cats?b("#tribe-events-header").data("baseurl"):
e.attr("href"),a.popping=!1,f.pre_ajax(function(){p()}))}).on("click","td.tribe-events-thismonth a",function(a){a.stopPropagation()}).on("click",'[id*="tribe-events-daynum-"] a',function(a){r.is(".tribe-mobile")&&(a.preventDefault(),a=b(this).closest(".mobile-trigger"),q(a.attr("data-day"),a.attr("data-date-name")))}).on("click",".mobile-trigger",function(a){r.is(".tribe-mobile")&&(a.preventDefault(),a.stopPropagation(),q(b(this).attr("data-day"),b(this).attr("data-date-name")))});f.snap("#tribe-bar-form",
"body","#tribe-events-footer .tribe-events-nav-previous, #tribe-events-footer .tribe-events-nav-next");b("form#tribe-bar-form").on("submit",function(a){A(a)});b(g).on("tribe_ev_runAjax",function(){p()});b(g).on("tribe_ev_updatingRecurrence",function(){a.date=b("#tribe-events-header").data("date");c.cur_url=a.filter_cats?b("#tribe-events-header").data("baseurl")+a.date+"/":s+a.date+"/";a.popping=!1});n&&debug.info("TEC Debug: tribe-events-ajax-calendar.js successfully loaded, Tribe Events Init finished");
n&&debug.timeEnd("Tribe JS Init Timer")})})(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
