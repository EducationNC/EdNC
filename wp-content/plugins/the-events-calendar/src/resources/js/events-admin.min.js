var tribeDateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,a=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};return function(i,r,d){var o=tribeDateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(i)||/\d/.test(i)||(r=i,i=void 0),"string"==typeof i&&(i=i.replace(/-/g,"/")),i=i?new Date(i):new Date,!isNaN(i)){r=String(o.masks[r]||r||o.masks["default"]),"UTC:"==r.slice(0,4)&&(r=r.slice(4),d=!0);var s=d?"getUTC":"get",c=i[s+"Date"](),l=i[s+"Day"](),y=i[s+"Month"](),m=i[s+"FullYear"](),u=i[s+"Hours"](),h=i[s+"Minutes"](),p=i[s+"Seconds"](),v=i[s+"Milliseconds"](),f=d?0:i.getTimezoneOffset(),g={d:c,dd:a(c),ddd:o.i18n.dayNames[l],dddd:o.i18n.dayNames[l+7],m:y+1,mm:a(y+1),mmm:o.i18n.monthNames[y],mmmm:o.i18n.monthNames[y+12],yy:String(m).slice(2),yyyy:m,h:u%12||12,hh:a(u%12||12),H:u,HH:a(u),M:h,MM:a(h),s:p,ss:a(p),l:a(v,3),L:a(v>99?Math.round(v/10):v),t:12>u?"a":"p",tt:12>u?"am":"pm",T:12>u?"A":"P",TT:12>u?"AM":"PM",Z:d?"UTC":(String(i).match(t)||[""]).pop().replace(n,""),o:(f>0?"-":"+")+a(100*Math.floor(Math.abs(f)/60)+Math.abs(f)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return r.replace(e,function(e){return e in g?g[e]:e.slice(1,e.length-1)})}}}();tribeDateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",tribeQuery:"yyyy-mm-dd",tribeMonthQuery:"yyyy-mm",0:"yyyy-mm-dd",1:"m/d/yyyy",2:"mm/dd/yyyy",3:"d/m/yyyy",4:"dd/mm/yyyy",5:"m-d-yyyy",6:"mm-dd-yyyy",7:"d-m-yyyy",8:"dd-mm-yyyy",m0:"yyyy-mm",m1:"m/yyyy",m2:"mm/yyyy",m3:"m/yyyy",m4:"mm/yyyy",m5:"m-yyyy",m6:"mm-yyyy",m7:"m-yyyy",m8:"mm-yyyy"},tribeDateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(e,t){return tribeDateFormat(this,e,t)};var tribe_datepicker_opts={};jQuery(document).ready(function(e){function t(){return m&&e(window).width()<768?1:3}function n(e,t){var n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((a-n)/g)}function a(){S.prop("checked")===!0?(_.hide(),M.hide()):(_.show(),M.show())}function i(e){"US"==e||"United States"==e?(N.show(),Q.hide()):""!=e?(Q.show(),N.hide()):(Q.hide(),N.hide())}function r(){I.find("option").each(function(){var t=e(this);J[t.attr("value")]=t.text()})}function d(){var t=I.find("option:selected").first().val();I.find("option").remove(),V.each(function(){var t=e(this);if(t.is(":checked")){var n=t.val();I.append('<option value="'+n+'">'+J[n]+"</option>")}});var n=I.find("option[value='"+t+"']");1===n.length?n.attr("selected","selected"):I.find("option").first().attr("selected","selected"),I.select2("destroy").select2({width:"250px"})}e(".bumpdown-trigger").bumpdown();var o=e("[data-datepicker_format]"),s=e(".tribe-field-dropdown_select2 select"),c=e("#view-calendar-link-div").html(),l=e('select[name="tribeEventsTemplate"]'),y=e("#tribe-event-datepickers"),m=e("body").is(".tribe_community_edit"),u=0,h={main:["yy-mm-dd","m/d/yy","mm/dd/yy","d/m/yy","dd/mm/yy","m-d-yy","mm-dd-yy","d-m-yy","dd-mm-yy"],month:["yy-mm","m/yy","mm/yy","m/yy","mm/yy","m-yy","mm-yy","m-yy","mm-yy"]};if(e(".chosen, .tribe-field-dropdown_chosen select").chosen(),e(".select2").select2({width:"250px"}),s.select2({width:"250px"}),e('[data-wp-lists="list:tribe_events_cat"]').each(function(){var t=e(this),n=t.find(":checkbox:checked").first();if(n.length){var a=t.find(":checkbox").position().top,i=n.position().top;t.closest(".tabs-panel").scrollTop(i-a+5)}}),e(c).insertAfter(".edit-php.post-type-tribe_events #wpbody-content .wrap h2:eq(0) a"),l.length&&""===l.val()){var p=l.find("option:selected").text();l.prev(".select2-container").children().children("span").text(p)}var v=function(){var t=wp.template("tribe-select-organizer"),n=wp.template("tribe-create-organizer"),a=e("#event_organizer"),i=a.find(".saved_organizer");a.on("click",".tribe-add-organizer",function(i){i.preventDefault();var r=e(t({}));if(r.find(".nosaved").length){var d=r.find("label");d.text(d.data("l10n-create-organizer")),r.find(".nosaved").remove()}var o=e(n({}));a.find("tfoot").before(o),o.prepend(r),o.find(".chosen").chosen().trigger("change")}),a.on("change",".organizer-dropdown",f),i.each(function(){var t=e(this),a=t.closest("tbody"),i=e(n({})).find(".organizer"),r=t.find(".organizer-dropdown");if(r.length){var d=r.val();"0"!=d&&i.hide()}else if(t.find(".nosaved").length){var o=t.find("label");o.text(o.data("l10n-create-organizer")),t.find(".nosaved").remove()}a.append(i)}),a.on("click",".delete-organizer-group",function(t){t.preventDefault();var n=e(this).closest("tbody");n.fadeOut(500,function(){e(this).remove()})});var r="> tbody";e("body").hasClass("wp-admin")||(r="table "+r),a.sortable({items:r,handle:".move-organizer-group",axis:"y",delay:100})},f=function(){var t=e(this),n=t.val(),a=t.closest("tbody"),i=a.find(".edit-organizer-link a"),r=i.attr("data-admin-url");"0"!=n?(a.find(".organizer").fadeOut().find("input").val(""),i.attr("href",r+n).show()):(a.find(".organizer").fadeIn(),i.hide())};if(e(".hide-if-js").hide(),"undefined"!=typeof TEC){var g=864e5,b="yy-mm-dd";o.length&&1===o.attr("data-datepicker_format").length&&(u=o.attr("data-datepicker_format"),b=h.main[u]);var D=0;y.length&&(D=y.data("startofweek"));var w=e("#EventEndDate");tribe_datepicker_opts={dateFormat:b,showAnim:"fadeIn",changeMonth:!0,changeYear:!0,numberOfMonths:t(),firstDay:D,showButtonPanel:!0,beforeShow:function(e,n){n.input.datepicker("option","numberOfMonths",t()),n.input.data("prevDate",n.input.datepicker("getDate"))},onSelect:function(t){var a="EventStartDate"==this.id?"minDate":"maxDate",i=e(this).data("datepicker"),r=e.datepicker.parseDate(i.settings.dateFormat||e.datepicker._defaults.dateFormat,t,i.settings);if("EventStartDate"===this.id){var d=e("#EventStartDate").data("prevDate"),o=null==d?0:n(d,w.datepicker("getDate")),s=new Date(r.setDate(r.getDate()+o));w.datepicker("option",a,s).datepicker("setDate",s)}else E.not(this).not(".tribe-no-end-date-update").datepicker("option",a,r)}},e.extend(tribe_datepicker_opts,TEC);var k,E=e(".tribe-datepicker").datepicker(tribe_datepicker_opts),S=e("#allDayCheckbox"),_=e(".timeofdayoptions"),M=e("#EventTimeFormatDiv"),C=e("select[name='EventStartMonth'], select[name='EventEndMonth']"),T=e("select[name='EventStartMonth']"),z=e('select[name="EventEndMonth"]');if(m){var F={start:y.find("#EventStartDate"),end:y.next("tr").find("#EventEndDate")};e.each(F,function(t,n){var a=e(n);""!==a.val()&&a.val(tribeDateFormat(a.val(),u))})}S.click(function(){a()}),a();var x=[29,31,28,31,30,31,30,31,31,30,31,30,31],$=[e("#28StartDays"),e("#29StartDays"),e("#30StartDays"),e("#31StartDays")],A=[e("#28EndDays"),e("#29EndDays"),e("#30EndDays"),e("#31EndDays")];C.change(function(){var t=e(this),n=t.attr("name");n="EventStartMonth"==n?"Start":"End";var a=t.attr("value");"0"==a.charAt(0)&&(a=a.replace("0",""));var i=e("select[name='Event"+n+"Year']").attr("value")%4;2==a&&0==i&&(a=0);var r=e("select[name='Event"+n+"Day']");e(".event"+n+"DateField").remove(),"Start"==n?(k=$[x[a]-28],k.val(r.val()),T.after(k)):(k=A[x[a]-28],k.val(r.val()),z.after(k))}),C.change(),e("select[name='EventStartYear']").change(function(){T.change()}),e("select[name='EventEndYear']").change(function(){z.change()});var O=e(".venue"),P=e("#saved_venue");P.length>0&&"0"!=P.val()&&(O.hide(),e('[name="venue[Venue]"]').val("")),P.change(function(){var t=e(this).val(),n=e(".edit-venue-link a").attr("data-admin-url");"0"==t?(O.fadeIn(),e("#EventCountry").val(0).trigger("chosen:updated"),e("#StateProvinceSelect").val(0).trigger("chosen:updated"),i(""),e(".edit-venue-link").hide()):(O.fadeOut(),e(".edit-venue-link").show(),e(".edit-venue-link a").attr("href",n+t))}),v()}var N=e("#StateProvinceSelect_chosen"),Q=e("#StateProvinceText");i(e("#EventCountry > option:selected").val()),e("#EventCountry").change(function(){var t=e(this).find("option:selected").val();i(t)});var j={$container:e("#overwrite_coordinates")};j.$lat=j.$container.find("#VenueLatitude"),j.$lng=j.$container.find("#VenueLongitude"),j.$fields=e("").add(j.$lat).add(j.$lng),j.$toggle=j.$container.find("#VenueOverwriteCoords").on("change",function(e){j.$toggle.is(":checked")?j.$fields.prop("disabled",!1).removeClass("hidden"):j.$fields.prop("disabled",!0).addClass("hidden")}),j.$toggle.trigger("change"),e("#EventInfo input, #EventInfo select").change(function(){e(".rec-error").hide()});var U=e('.wp-admin.events-cal #post #publishing-action input[type="submit"]');U.click(function(){e(this).data("clicked",!0)}),e("body").hasClass("post-type-tribe_venue")&&e("#menu-posts-tribe_events, #menu-posts-tribe_events a.wp-has-submenu").addClass("wp-menu-open wp-has-current-submenu wp-has-submenu").removeClass("wp-not-current-submenu").find("li a[href='edit.php?post_type=tribe_venue']").parent().addClass("current"),e("body").hasClass("post-type-tribe_organizer")&&e("#menu-posts-tribe_events, #menu-posts-tribe_events a.wp-has-submenu").addClass("wp-menu-open wp-has-current-submenu wp-has-submenu").removeClass("wp-not-current-submenu").find("li a[href='edit.php?post_type=tribe_organizer']").parent().addClass("current");var H=e("#tribe-field-tribeEnableViews");if(H.length){var I=e('.tribe-field-dropdown_select2 select[name="viewOption"]'),V=H.find("input:checkbox"),Y=e("#tribe-field-tribeEnableViews .tribe-field-wrap p.description"),J={};r(),H.on("change","input:checkbox",function(){var t=e(this);e('[name="tribeEnableViews[]"]:checked').length<1?(t.attr("checked",!0),Y.css("color","red")):Y.removeAttr("style"),d()})}e("#tribe-community-events.form form").on("submit",function(){var t={start:y.find("#EventStartDate"),end:y.next("tr").find("#EventEndDate")};t.start.val(tribeDateFormat(t.start.datepicker("getDate"),"tribeQuery")),t.end.val(tribeDateFormat(t.end.datepicker("getDate"),"tribeQuery")),y.parent().find(".tribe-no-end-date-update").each(function(){$el=e(this),$el.is(":visible")&&$el.val(tribeDateFormat($el.datepicker("getDate"),"tribeQuery"))})})}),jQuery(document).ajaxSuccess(function(e,t,n){"undefined"!=typeof n&&"undefined"!=typeof n.data&&-1!=n.data.search("action=save-widget")&&jQuery("#widgets-right .chosen").chosen()}),jQuery(document).ready(function(e){var t=e("#EventInfo").find("tr.event-timezone"),n=t.find("label"),a=t.find("select"),i=t.find(".chosen-container"),r=a.parent("td"),d=n.html(),o=a.find("option:selected").html(),s="<a href='#' class='change_tz'>"+d+" "+o+"</a>";n.hide(),i.hide(),r.append(s),r.find("a.change_tz").click(function(t){return t.stopImmediatePropagation(),e(this).hide(),i.show(),!1})});