var tribeDateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a};return function(e,f,g){var h=tribeDateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(f=e,e=void 0),"string"==typeof e&&(e=e.replace(/-/g,"/")),e=e?new Date(e):new Date,!isNaN(e)){f=String(h.masks[f]||f||h.masks["default"]),"UTC:"==f.slice(0,4)&&(f=f.slice(4),g=!0);var i=g?"getUTC":"get",j=e[i+"Date"](),k=e[i+"Day"](),l=e[i+"Month"](),m=e[i+"FullYear"](),n=e[i+"Hours"](),o=e[i+"Minutes"](),p=e[i+"Seconds"](),q=e[i+"Milliseconds"](),r=g?0:e.getTimezoneOffset(),s={d:j,dd:d(j),ddd:h.i18n.dayNames[k],dddd:h.i18n.dayNames[k+7],m:l+1,mm:d(l+1),mmm:h.i18n.monthNames[l],mmmm:h.i18n.monthNames[l+12],yy:String(m).slice(2),yyyy:m,h:n%12||12,hh:d(n%12||12),H:n,HH:d(n),M:o,MM:d(o),s:p,ss:d(p),l:d(q,3),L:d(q>99?Math.round(q/10):q),t:12>n?"a":"p",tt:12>n?"am":"pm",T:12>n?"A":"P",TT:12>n?"AM":"PM",Z:g?"UTC":(String(e).match(b)||[""]).pop().replace(c,""),o:(r>0?"-":"+")+d(100*Math.floor(Math.abs(r)/60)+Math.abs(r)%60,4),S:["th","st","nd","rd"][j%10>3?0:(j%100-j%10!=10)*j%10]};return f.replace(a,function(a){return a in s?s[a]:a.slice(1,a.length-1)})}}}();tribeDateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",tribeQuery:"yyyy-mm-dd",tribeMonthQuery:"yyyy-mm",0:"yyyy-mm-dd",1:"m/d/yyyy",2:"mm/dd/yyyy",3:"d/m/yyyy",4:"dd/mm/yyyy",5:"m-d-yyyy",6:"mm-dd-yyyy",7:"d-m-yyyy",8:"dd-mm-yyyy",m0:"yyyy-mm",m1:"m/yyyy",m2:"mm/yyyy",m3:"m/yyyy",m4:"mm/yyyy",m5:"m-yyyy",m6:"mm-yyyy",m7:"m-yyyy",m8:"mm-yyyy"},tribeDateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(a,b){return tribeDateFormat(this,a,b)};var tribe_datepicker_opts={};jQuery(document).ready(function(a){function b(){return m&&a(window).width()<768?1:3}function c(a,b){var c=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),d=Date.UTC(b.getFullYear(),b.getMonth(),b.getDate());return Math.floor((d-c)/s)}function d(){y.prop("checked")===!0?(z.hide(),A.hide()):(z.show(),A.show())}function e(a){"US"==a||"United States"==a?(K.show(),L.hide()):""!=a?(L.show(),K.hide()):(L.hide(),K.hide())}function f(){P.find("option").each(function(){var b=a(this);S[b.attr("value")]=b.text()})}function g(){var b=P.find("option:selected").first().val();P.find("option").remove(),Q.each(function(){var b=a(this);if(b.is(":checked")){var c=b.val();P.append('<option value="'+c+'">'+S[c]+"</option>")}});var c=P.find("option[value='"+b+"']");1===c.length?c.attr("selected","selected"):P.find("option").first().attr("selected","selected"),P.select2("destroy").select2({width:"250px"})}a(".bumpdown-trigger").bumpdown();var h=a("[data-datepicker_format]"),i=a(".tribe-field-dropdown_select2 select"),j=a("#view-calendar-link-div").html(),k=a('select[name="tribeEventsTemplate"]'),l=a("#tribe-event-datepickers"),m=a("body").is(".tribe_community_edit"),n=0,o={main:["yy-mm-dd","m/d/yy","mm/dd/yy","d/m/yy","dd/mm/yy","m-d-yy","mm-dd-yy","d-m-yy","dd-mm-yy"],month:["yy-mm","m/yy","mm/yy","m/yy","mm/yy","m-yy","mm-yy","m-yy","mm-yy"]};if(a(".chosen, .tribe-field-dropdown_chosen select").chosen(),a(".select2").select2({width:"250px"}),i.select2({width:"250px"}),a('[data-wp-lists="list:tribe_events_cat"]').each(function(){var b=a(this),c=b.find(":checkbox:checked").first();if(c.length){var d=b.find(":checkbox").position().top,e=c.position().top;b.closest(".tabs-panel").scrollTop(e-d+5)}}),a(j).insertAfter(".edit-php.post-type-tribe_events #wpbody-content .wrap h2:eq(0) a"),k.length&&""===k.val()){var p=k.find("option:selected").text();k.prev(".select2-container").children().children("span").text(p)}var q=function(){var b=wp.template("tribe-select-organizer"),c=wp.template("tribe-create-organizer"),d=a("#event_organizer"),e=d.find(".saved_organizer");d.on("click",".tribe-add-organizer",function(e){e.preventDefault();var f=a(b({}));if(f.find(".nosaved").length){var g=f.find("label");g.text(g.data("l10n-create-organizer")),f.find(".nosaved").remove()}var h=a(c({}));d.find("tfoot").before(h),h.prepend(f),h.find(".chosen").chosen().trigger("change")}),d.on("change",".organizer-dropdown",r),e.each(function(){var b=a(this),d=b.closest("tbody"),e=a(c({})).find(".organizer"),f=b.find(".organizer-dropdown");if(f.length){var g=f.val();"0"!=g&&e.hide()}else if(b.find(".nosaved").length){var h=b.find("label");h.text(h.data("l10n-create-organizer")),b.find(".nosaved").remove()}d.append(e)}),d.on("click",".delete-organizer-group",function(b){b.preventDefault();var c=a(this).closest("tbody");c.fadeOut(500,function(){a(this).remove()})});var f="> tbody";a("body").hasClass("wp-admin")||(f="table "+f),d.sortable({items:f,handle:".move-organizer-group",axis:"y",delay:100})},r=function(){var b=a(this),c=b.val(),d=b.closest("tbody"),e=d.find(".edit-organizer-link a"),f=e.attr("data-admin-url");"0"!=c?(d.find(".organizer").fadeOut().find("input").val(""),e.attr("href",f+c).show()):(d.find(".organizer").fadeIn(),e.hide())};if(a(".hide-if-js").hide(),"undefined"!=typeof TEC){var s=864e5,t="yy-mm-dd";h.length&&1===h.attr("data-datepicker_format").length&&(n=h.attr("data-datepicker_format"),t=o.main[n]);var u=0;l.length&&(u=l.data("startofweek"));var v=a("#EventEndDate");tribe_datepicker_opts={dateFormat:t,showAnim:"fadeIn",changeMonth:!0,changeYear:!0,numberOfMonths:b(),firstDay:u,showButtonPanel:!0,beforeShow:function(a,c){c.input.datepicker("option","numberOfMonths",b()),c.input.data("prevDate",c.input.datepicker("getDate"))},onSelect:function(b){var d="EventStartDate"==this.id?"minDate":"maxDate",e=a(this).data("datepicker"),f=a.datepicker.parseDate(e.settings.dateFormat||a.datepicker._defaults.dateFormat,b,e.settings);if("EventStartDate"===this.id){var g=a("#EventStartDate").data("prevDate"),h=null==g?0:c(g,v.datepicker("getDate")),i=new Date(f.setDate(f.getDate()+h));v.datepicker("option",d,i).datepicker("setDate",i)}else x.not(this).not(".tribe-no-end-date-update").datepicker("option",d,f)}},a.extend(tribe_datepicker_opts,TEC);var w,x=a(".tribe-datepicker").datepicker(tribe_datepicker_opts),y=a("#allDayCheckbox"),z=a(".timeofdayoptions"),A=a("#EventTimeFormatDiv"),B=a("select[name='EventStartMonth'], select[name='EventEndMonth']"),C=a("select[name='EventStartMonth']"),D=a('select[name="EventEndMonth"]');if(m){var E={start:l.find("#EventStartDate"),end:l.next("tr").find("#EventEndDate")};a.each(E,function(b,c){var d=a(c);""!==d.val()&&d.val(tribeDateFormat(d.val(),n))})}y.click(function(){d()}),d();var F=[29,31,28,31,30,31,30,31,31,30,31,30,31],G=[a("#28StartDays"),a("#29StartDays"),a("#30StartDays"),a("#31StartDays")],H=[a("#28EndDays"),a("#29EndDays"),a("#30EndDays"),a("#31EndDays")];B.change(function(){var b=a(this),c=b.attr("name");c="EventStartMonth"==c?"Start":"End";var d=b.attr("value");"0"==d.charAt(0)&&(d=d.replace("0",""));var e=a("select[name='Event"+c+"Year']").attr("value")%4;2==d&&0==e&&(d=0);var f=a("select[name='Event"+c+"Day']");a(".event"+c+"DateField").remove(),"Start"==c?(w=G[F[d]-28],w.val(f.val()),C.after(w)):(w=H[F[d]-28],w.val(f.val()),D.after(w))}),B.change(),a("select[name='EventStartYear']").change(function(){C.change()}),a("select[name='EventEndYear']").change(function(){D.change()});var I=a(".venue"),J=a("#saved_venue");J.length>0&&"0"!=J.val()&&(I.hide(),a('[name="venue[Venue]"]').val("")),J.change(function(){var b=a(this).val(),c=a(".edit-venue-link a").attr("data-admin-url");"0"==b?(I.fadeIn(),a("#EventCountry").val(0).trigger("chosen:updated"),a("#StateProvinceSelect").val(0).trigger("chosen:updated"),e(""),a(".edit-venue-link").hide()):(I.fadeOut(),a(".edit-venue-link").show(),a(".edit-venue-link a").attr("href",c+b))}),q()}var K=a("#StateProvinceSelect_chosen"),L=a("#StateProvinceText");e(a("#EventCountry > option:selected").val()),a("#EventCountry").change(function(){var b=a(this).find("option:selected").val();e(b)});var M={$container:a("#overwrite_coordinates")};M.$lat=M.$container.find("#VenueLatitude"),M.$lng=M.$container.find("#VenueLongitude"),M.$fields=a("").add(M.$lat).add(M.$lng),M.$toggle=M.$container.find("#VenueOverwriteCoords").on("change",function(a){M.$toggle.is(":checked")?M.$fields.prop("disabled",!1).removeClass("hidden"):M.$fields.prop("disabled",!0).addClass("hidden")}),M.$toggle.trigger("change"),a("#EventInfo input, #EventInfo select").change(function(){a(".rec-error").hide()});var N=a('.wp-admin.events-cal #post #publishing-action input[type="submit"]');N.click(function(){a(this).data("clicked",!0)}),a("body").hasClass("post-type-tribe_venue")&&a("#menu-posts-tribe_events, #menu-posts-tribe_events a.wp-has-submenu").addClass("wp-menu-open wp-has-current-submenu wp-has-submenu").removeClass("wp-not-current-submenu").find("li a[href='edit.php?post_type=tribe_venue']").parent().addClass("current"),a("body").hasClass("post-type-tribe_organizer")&&a("#menu-posts-tribe_events, #menu-posts-tribe_events a.wp-has-submenu").addClass("wp-menu-open wp-has-current-submenu wp-has-submenu").removeClass("wp-not-current-submenu").find("li a[href='edit.php?post_type=tribe_organizer']").parent().addClass("current");var O=a("#tribe-field-tribeEnableViews");if(O.length){var P=a('.tribe-field-dropdown_select2 select[name="viewOption"]'),Q=O.find("input:checkbox"),R=a("#tribe-field-tribeEnableViews .tribe-field-wrap p.description"),S={};f(),O.on("change","input:checkbox",function(){var b=a(this);a('[name="tribeEnableViews[]"]:checked').length<1?(b.attr("checked",!0),R.css("color","red")):R.removeAttr("style"),g()})}a("#tribe-community-events.form form").on("submit",function(){var b={start:l.find("#EventStartDate"),end:l.next("tr").find("#EventEndDate")};b.start.val(tribeDateFormat(b.start.datepicker("getDate"),"tribeQuery")),b.end.val(tribeDateFormat(b.end.datepicker("getDate"),"tribeQuery")),l.parent().find(".tribe-no-end-date-update").each(function(){$el=a(this),$el.is(":visible")&&$el.val(tribeDateFormat($el.datepicker("getDate"),"tribeQuery"))})})}),jQuery(document).ajaxSuccess(function(a,b,c){"undefined"!=typeof c&&"undefined"!=typeof c.data&&-1!=c.data.search("action=save-widget")&&jQuery("#widgets-right .chosen").chosen()}),jQuery(document).ready(function(a){var b=a("#EventInfo").find("tr.event-timezone"),c=b.find("label"),d=b.find("select"),e=b.find(".chosen-container"),f=d.parent("td"),g=c.html(),h=d.find("option:selected").html(),i="<a href='#' class='change_tz'>"+g+" "+h+"</a>";c.hide(),e.hide(),f.append(i),f.find("a.change_tz").click(function(b){return b.stopImmediatePropagation(),a(this).hide(),e.show(),!1})});